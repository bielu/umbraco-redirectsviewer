<div ng-controller="Our.Umbraco.RedirectsViewer.SettingsController as vm">
    <div class="umb-box">
        <div class="umb-box-content">
            <h3 class="bold">
                <localize key="redirectsviewer_headerText">Redirect viewer permissions</localize>
            </h3>
            <p>
                <localize key="redirectsviewer_introText">Redirect content app permissions can be set here, select
                    groups that can create or delete redirects
                </localize>
            </p>
        </div>
    </div>
    <div ng-if="!vm.loading" class="umb-box">
        <div class="umb-panel-group__details-group-title">
            <div class="umb-panel-group__details-group-name">
                <localize key="redirectsviewer_createHeading">Create</localize>
            </div>
        </div>
        <div>
            <ul class="unstyled">
                <li>
                    <label class="checkbox">
                        <input type="checkbox" ng-model="vm.settings.create.allowed"/>
                    </label>
                </li>
            </ul>

            <div class="umb-panel-group__details-check-description" ng-if="vm.settings.create.allowed">
                <localize key="redirectsviewer_prevalueUsergroups">Select the user groups that have these rights. Admins
                    will always have these rights
                </localize>
            </div>
            <ul class="unstyled" ng-if="vm.settings.create.allowed">

                <li ng-repeat="item in vm.createGroups">
                    <label class="checkbox">
                        <input type="checkbox" name="groups" value="{{item.alias}}" ng-model="item.checked"/>
                        {{item.name}}
                    </label>
                </li>
            </ul>
        </div>

    </div>
    <div ng-if="!vm.loading" class="umb-box">
        <div class="umb-panel-group__details-group-title">
            <div class="umb-panel-group__details-group-name">
                <localize key="redirectsviewer_deleteHeading">Delete</localize>
            </div>
        </div>
        <ul class="unstyled">
            <li>
                <label class="checkbox">
                    <input type="checkbox" ng-model="vm.settings.delete.allowed"/>
                </label>
            </li>
        </ul>

        <div class="umb-panel-group__details-check-description" ng-if="vm.settings.delete.allowed">
            <localize key="redirectsviewer_prevalueUsergroups">Select the user groups that have these rights. Admins
                will always have these rights
            </localize>
        </div>
        <ul class="unstyled" ng-if="vm.settings.delete.allowed">
            <li ng-repeat="item in vm.deleteGroups">
                <label class="checkbox">
                    <input type="checkbox" name="groups" value="{{item.alias}}" ng-model="item.checked"/>
                    {{item.name}}
                </label>
            </li>
        </ul>
        <div class="umb-panel-group__details-status-action">
            <umb-button type="button"
                        button-style="success"
                        label-key="redirectsviewer_saveSettings"
                        action="vm.saveSettings()"
                        disabled="vm.working"/>
        </div>

    </div>
    <div ng-if="!vm.loading" class="umb-box">
        <div class="umb-panel-group__details-group-title">
            <div class="umb-panel-group__details-group-name">
                <localize key="redirectsviewer_import">Import</localize>
            </div>
        </div>
        <div ng-if="!vm.loading" class="umb-box">
            <div class="umb-dashboard__content">
                <div class="" ng-if="statusImportItems">
                    {{vm.importedCount}} / {{vm.total}}
                    <table class="unstyled status-table" id="redirectStatusTable">
                        <tr>
                            <th></th>
                            <th>Source URL</th>
                            <th>Target (URL/ID/GUID)</th>
                            <th>Status</th>
                        </tr>
                        <tbody ng-repeat="(key,item) in statusImportItems">
                        <tr ng-repeat="(source,target) in item" ng-class="{success: key == 1}">
                            <td>
                                <i class="umb-healthcheck-status-icon icon-check color-green" ng-if="key == 1"></i>
                                <i class="umb-healthcheck-status-icon icon-delete icon-delete color-red"
                                   ng-if="key == 2"></i>
                            </td>
                            <td>{{source}}</td>
                            <td>{{target}}</td>
                            <td>
                        <span ng-if="key == 1">
                                <localize key="redirectsviewer_created">
                                    Created
                                </localize>
                        </span>
                                <span ng-if="key == 2">
                                <localize key="redirectsviewer_noContent">
                                    Target Content doesn't exists
                                </localize>
                                                        </span>

                                <span ng-if="key == 3">
                                <localize key="redirectsviewer_exists">
                                    New URL does not exist in Umbraco
                                </localize>
                                </span>
                                <span ng-if="key == 4">
                                <localize key="redirectsviewer_unknown">
                                   Unknown error
                                </localize>
                                </span>
                            </td>


                        </tr>

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="umb-panel-group__details-status-action">
                <umb-button type="button"
                            button-style="success"
                            label-key="redirectsviewer_import"
                            action="vm.import()"
                            disabled="vm.working"/>
                <umb-button type="button"
                            button-style="danger"
                            ng-if="importFinished"
                            label-key="redirectsviewer_import_errors"
                            action="vm.export()"
                            disabled="vm.working"/>
            </div>
        </div>
    


    </div>
</div>